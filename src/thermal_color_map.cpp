#include <qwt_color_map.h>
#include <qwt_matrix_raster_data.h>
#include <qwt_plot.h>
#include <qwt_plot_curve.h>
#include <qwt_plot_spectrogram.h>

#include <thermal_color_map.hpp>

ThermalColorMap::ThermalColorMap() {
    QVector<QColor> colors = {
        QColor(0, 0, 0),
        QColor(0, 0, 2),
        QColor(0, 0, 4),
        QColor(0, 0, 6),
        QColor(0, 0, 8),
        QColor(0, 0, 10),
        QColor(0, 0, 12),
        QColor(0, 0, 14),
        QColor(0, 0, 16),
        QColor(0, 0, 17),
        QColor(0, 0, 19),
        QColor(0, 0, 21),
        QColor(0, 0, 23),
        QColor(0, 0, 25),
        QColor(0, 0, 27),
        QColor(0, 0, 29),
        QColor(0, 0, 31),
        QColor(0, 0, 33),
        QColor(0, 0, 35),
        QColor(0, 0, 37),
        QColor(0, 0, 39),
        QColor(0, 0, 41),
        QColor(0, 0, 43),
        QColor(0, 0, 45),
        QColor(0, 0, 47),
        QColor(0, 0, 49),
        QColor(0, 0, 51),
        QColor(0, 0, 53),
        QColor(0, 0, 55),
        QColor(0, 0, 57),
        QColor(0, 0, 59),
        QColor(0, 0, 61),
        QColor(0, 0, 63),
        QColor(0, 0, 65),
        QColor(0, 0, 67),
        QColor(0, 0, 69),
        QColor(0, 0, 71),
        QColor(0, 0, 73),
        QColor(0, 0, 75),
        QColor(0, 0, 77),
        QColor(0, 0, 79),
        QColor(0, 0, 81),
        QColor(0, 0, 83),
        QColor(0, 0, 84),
        QColor(0, 0, 86),
        QColor(0, 0, 88),
        QColor(0, 0, 90),
        QColor(0, 0, 92),
        QColor(0, 0, 94),
        QColor(0, 0, 96),
        QColor(0, 0, 98),
        QColor(0, 0, 100),
        QColor(0, 0, 102),
        QColor(0, 0, 104),
        QColor(0, 0, 106),
        QColor(0, 0, 108),
        QColor(0, 0, 110),
        QColor(0, 0, 112),
        QColor(0, 0, 114),
        QColor(0, 0, 116),
        QColor(0, 0, 117),
        QColor(0, 0, 119),
        QColor(0, 0, 121),
        QColor(0, 0, 123),
        QColor(0, 0, 125),
        QColor(0, 0, 127),
        QColor(0, 0, 129),
        QColor(0, 0, 131),
        QColor(0, 0, 133),
        QColor(0, 0, 135),
        QColor(0, 0, 137),
        QColor(0, 0, 139),
        QColor(0, 0, 141),
        QColor(0, 0, 143),
        QColor(0, 0, 145),
        QColor(0, 0, 147),
        QColor(0, 0, 149),
        QColor(0, 0, 151),
        QColor(0, 0, 153),
        QColor(0, 0, 155),
        QColor(0, 0, 157),
        QColor(0, 0, 159),
        QColor(0, 0, 161),
        QColor(0, 0, 163),
        QColor(0, 0, 165),
        QColor(0, 0, 167),
        QColor(3, 0, 169),
        QColor(6, 0, 171),
        QColor(9, 0, 173),
        QColor(12, 0, 175),
        QColor(15, 0, 177),
        QColor(18, 0, 179),
        QColor(21, 0, 181),
        QColor(24, 0, 183),
        QColor(26, 0, 184),
        QColor(29, 0, 186),
        QColor(32, 0, 188),
        QColor(35, 0, 190),
        QColor(38, 0, 192),
        QColor(41, 0, 194),
        QColor(44, 0, 196),
        QColor(47, 0, 198),
        QColor(50, 0, 200),
        QColor(52, 0, 197),
        QColor(55, 0, 194),
        QColor(57, 0, 191),
        QColor(59, 0, 188),
        QColor(62, 0, 185),
        QColor(64, 0, 182),
        QColor(66, 0, 179),
        QColor(69, 0, 176),
        QColor(71, 0, 174),
        QColor(74, 0, 171),
        QColor(76, 0, 168),
        QColor(78, 0, 165),
        QColor(81, 0, 162),
        QColor(83, 0, 159),
        QColor(85, 0, 156),
        QColor(88, 0, 153),
        QColor(90, 0, 150),
        QColor(93, 2, 144),
        QColor(96, 4, 138),
        QColor(99, 6, 132),
        QColor(102, 8, 126),
        QColor(105, 9, 121),
        QColor(108, 11, 115),
        QColor(111, 13, 109),
        QColor(114, 15, 103),
        QColor(116, 17, 97),
        QColor(119, 19, 91),
        QColor(122, 21, 85),
        QColor(125, 23, 79),
        QColor(128, 24, 74),
        QColor(131, 26, 68),
        QColor(134, 28, 62),
        QColor(137, 30, 56),
        QColor(140, 32, 50),
        QColor(143, 34, 47),
        QColor(146, 36, 44),
        QColor(149, 38, 41),
        QColor(152, 40, 38),
        QColor(155, 41, 35),
        QColor(158, 43, 32),
        QColor(161, 45, 29),
        QColor(164, 47, 26),
        QColor(166, 49, 24),
        QColor(169, 51, 21),
        QColor(172, 53, 18),
        QColor(175, 55, 15),
        QColor(178, 56, 12),
        QColor(181, 58, 9),
        QColor(184, 60, 6),
        QColor(187, 62, 3),
        QColor(190, 64, 0),
        QColor(194, 66, 0),
        QColor(198, 68, 0),
        QColor(201, 70, 0),
        QColor(205, 72, 0),
        QColor(209, 73, 0),
        QColor(213, 75, 0),
        QColor(217, 77, 0),
        QColor(221, 79, 0),
        QColor(224, 81, 0),
        QColor(228, 83, 0),
        QColor(232, 85, 0),
        QColor(236, 87, 0),
        QColor(240, 88, 0),
        QColor(244, 90, 0),
        QColor(247, 92, 0),
        QColor(251, 94, 0),
        QColor(255, 96, 0),
        QColor(255, 98, 3),
        QColor(255, 100, 6),
        QColor(255, 102, 9),
        QColor(255, 104, 12),
        QColor(255, 105, 15),
        QColor(255, 107, 18),
        QColor(255, 109, 21),
        QColor(255, 111, 24),
        QColor(255, 113, 26),
        QColor(255, 115, 29),
        QColor(255, 117, 32),
        QColor(255, 119, 35),
        QColor(255, 120, 38),
        QColor(255, 122, 41),
        QColor(255, 124, 44),
        QColor(255, 126, 47),
        QColor(255, 128, 50),
        QColor(255, 130, 53),
        QColor(255, 132, 56),
        QColor(255, 134, 59),
        QColor(255, 136, 62),
        QColor(255, 137, 65),
        QColor(255, 139, 68),
        QColor(255, 141, 71),
        QColor(255, 143, 74),
        QColor(255, 145, 76),
        QColor(255, 147, 79),
        QColor(255, 149, 82),
        QColor(255, 151, 85),
        QColor(255, 152, 88),
        QColor(255, 154, 91),
        QColor(255, 156, 94),
        QColor(255, 158, 97),
        QColor(255, 160, 100),
        QColor(255, 162, 103),
        QColor(255, 164, 106),
        QColor(255, 166, 109),
        QColor(255, 168, 112),
        QColor(255, 169, 115),
        QColor(255, 171, 118),
        QColor(255, 173, 121),
        QColor(255, 175, 124),
        QColor(255, 177, 126),
        QColor(255, 179, 129),
        QColor(255, 181, 132),
        QColor(255, 183, 135),
        QColor(255, 184, 138),
        QColor(255, 186, 141),
        QColor(255, 188, 144),
        QColor(255, 190, 147),
        QColor(255, 192, 150),
        QColor(255, 194, 153),
        QColor(255, 196, 156),
        QColor(255, 198, 159),
        QColor(255, 200, 162),
        QColor(255, 201, 165),
        QColor(255, 203, 168),
        QColor(255, 205, 171),
        QColor(255, 207, 174),
        QColor(255, 209, 176),
        QColor(255, 211, 179),
        QColor(255, 213, 182),
        QColor(255, 215, 185),
        QColor(255, 216, 188),
        QColor(255, 218, 191),
        QColor(255, 220, 194),
        QColor(255, 222, 197),
        QColor(255, 224, 200),
        QColor(255, 226, 203),
        QColor(255, 228, 206),
        QColor(255, 229, 210),
        QColor(255, 231, 213),
        QColor(255, 233, 216),
        QColor(255, 235, 219),
        QColor(255, 237, 223),
        QColor(255, 239, 226),
        QColor(255, 240, 229),
        QColor(255, 242, 232),
        QColor(255, 244, 236),
        QColor(255, 246, 239),
        QColor(255, 248, 242),
        QColor(255, 250, 245),
        QColor(255, 251, 249),
        QColor(255, 253, 252),
        QColor(255, 255, 255)};

    // Add each color as a color stop at a normalized position from 0 to 1.
    const int nStops = colors.size();
    for (int i = 0; i < nStops; ++i) {
        double pos = static_cast<double>(i) / (nStops - 1);
        addColorStop(pos, colors[i]);
    }
}

QRgb ThermalColorMap::rgb(const QwtInterval &interval, double value) const {
    if (value <= interval.minValue()) {
        return qRgb(0, 0, 0);
    }

    return QwtLinearColorMap::rgb(interval, value);
}
